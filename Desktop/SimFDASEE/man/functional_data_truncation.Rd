% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functional_data_truncation.R
\name{functional_data_truncation}
\alias{functional_data_truncation}
\title{Functional Data Truncation Based on Covariance Eigenstructure}
\usage{
functional_data_truncation(d, C, data, Delta, sd)
}
\arguments{
\item{d}{Integer. Number of leading eigenvalues/components to consider for inversion.}

\item{C}{Numeric matrix. Covariance matrix of the functional data.}

\item{data}{Numeric matrix. Functional data with rows corresponding to time points and columns to spatial/grid points.}

\item{Delta}{Numeric. Increment size used in the threshold calculation.}

\item{sd}{Numeric. Number of standard deviations used to define the truncation threshold.}
}
\value{
A list with two elements:
\describe{
\item{gn}{Numeric vector of truncation function values for each time point.}
\item{locations}{Integer indices of time points where \code{gn} exceeds the threshold.}
}
}
\description{
This function computes a truncation function for functional data and identifies
time points where the function exceeds a threshold based on the covariance structure.
It is useful for detecting extreme or influential observations in functional time series.
}
\examples{
x_grid <- seq(0, 1, length.out = 100)
q <- outer(x_grid, x_grid, function(x, y) exp(-abs(x - y)))
data <- matrix(rnorm(100*50), nrow = 50, ncol = 100)
functional_data_truncation(d = 5, C = q, data = data, Delta = 0.01, sd = 3)

}
