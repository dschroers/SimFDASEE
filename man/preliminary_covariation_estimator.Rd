% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/preliminary_corvariation_estimator.R
\name{preliminary_covariation_estimator}
\alias{preliminary_covariation_estimator}
\title{Preliminary Covariation Estimator for Functional Data}
\usage{
preliminary_covariation_estimator(data, tq)
}
\arguments{
\item{data}{Numeric matrix. Functional data with rows corresponding to time points and columns to spatial/grid points.}

\item{tq}{Numeric. Truncation quantile used to identify extreme observations via \code{quantile_truncation}.}
}
\value{
A numeric matrix representing the preliminary estimated covariance matrix.
}
\description{
This function computes a preliminary estimator of the covariance (or covariation)
matrix for functional data after removing extreme observations based on a
truncation threshold. It also scales the covariance matrix using a robust
estimate of the leading eigenvalue contribution.
}
\details{
The function first identifies "rough" truncation locations based on the specified quantile \code{tq}
using the \code{quantile_truncation} function. These rows are removed from the data to reduce the
effect of extreme observations. The covariance of the truncated data is computed and scaled
by \code{rho.star}, which is derived from the interquartile range of projections onto the leading
eigenvector, to produce a robust preliminary covariation estimator.
}
\examples{
# Simulate functional data
set.seed(123)
data <- matrix(rnorm(50*100), nrow = 50, ncol = 100)
preliminary_covariation_estimator(data, tq = 0.95)

}
